<html>
<head>
  <title>TextInput for SpeechSynthesisUtterance</title>
  <style>
    body {
      background: #F9F5E9;
      color: #111;
      font-family: "Sitka Text", 'KoPub Batang', Georgia, Cambria, Calibri, serif;
      font-size: 114%;
    }

    #display p {
      margin: .6em;
    }

    div:has(textarea) {
      display: flex;
      justify-content: center;
      align-items: end;
      gap: .5em;
      margin-bottom: 1rem;
    }
  </style>
  <link rel="shortcut icon" href="favicon.png" type="image/x-icon">
</head>
<body>
  <div>
    <textarea type="text" id="myInput" cols="50" rows="2"></textarea>
    <button type="button" onclick="transform()">변환</button>
  </div>

  <div id="display" onclick="selectText(this)">
  </div>

  <script>
    let clickStatue = false

    function transform() {
      const $textarea = document.getElementById('myInput');
      const $display = document.getElementById('display');

      $display.innerText = '';

      const lines = $textarea.value.split(/(?<=다|요)\n/)
      console.log('lines: ', lines);
      for (let i = 0; i < lines.length; i++) {
        if (lines[i] !== '') {
          const $p = document.createElement('p');
          $p.textContent = lines[i];
          $display.appendChild($p);
        }
      }

      $textarea.value = '';
    }

    function selectText($element) {
      if (!clickStatue) {
        if (document.selection) {
          const range = document.body.createTextRange();
          range.moveToElementText($element);
          range.select();
        } else if (window.getSelection) {
          const range = document.createRange();
          range.selectNode($element);
          window.getSelection().removeAllRanges();
          window.getSelection().addRange(range);
        }
        clickStatue = true
      } else {
        clickStatue = false
      }
    }
  </script>
</body>
</html>